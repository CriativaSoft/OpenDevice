
<ul id="page-header" class="nav navbar-nav">
    <li>
        <i class="fa fa-dashboard"></i> Dashboard :
    </li>
    <li class="dropdown" ng-if="!ctrl.editMode">
        <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">${ctrl.dashboard.title}<span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li ng-repeat="current in ctrl.dashboardList"><a href="javascript:void(0)" target="_self" ng-click="ctrl.activateDash(current);">${current.title}</a></li>
        </ul>
    </li>

    <li ng-if="ctrl.editMode">
        <form ng-submit="ctrl.save($event)" class="navbar-form" role="form">

            <div class="input-group">
                <input type="text" name="title" class="form-control" ng-value="ctrl.dashboard.title" />
                <input type="hidden" name="id" class="form-control" ng-value="ctrl.dashboard.id" />
                <div class="input-group-btn">
                    <button class="btn btn-default" type="submit" title="Save (CTRL + S)"><i class="fa fa-save"></i></button>
                    <button class="btn btn-default" ng-click="ctrl.delete()" title="Delete Dashboard #${ctrl.dashboard.id}"><i class="fa fa-remove"></i></button>
                </div>
            </div>
        </form>
    </li>

    <li><a href="javascript:void(0);" ng-if="!ctrl.editMode" ng-click="ctrl.toggleEdit(true)" title="Edit (F2)"><i class="fa fa-edit"></i></a></li>

    <li><a href="javascript:void(0);" ng-if="ctrl.editMode" ng-click="ctrl.toggleEdit(false)" title="Cancel Edition (F2)"><i class="fa fa-reply"></i></a></li>
</ul>



<ul id="page-actions" class="nav navbar-nav">

    <li><a href="javascript:void(0);" target="_self" ng-click="ctrl.addNewDash()"><i class="fa fa-plus"></i> Dashboard</a></li>

    <li ng-init="page.replace('#app-header', '#page-header');page.replace('#app-header-actions', '#page-actions')"></li>
</ul>


<!-- Main content -->
<section class="content dashboard-page" data-ng-init="ctrl.init()">

    <!----------------------------------------------------------------->
    <!-- Add Dashboards Actions                                      -->
    <!----------------------------------------------------------------->

    <div class="row animate-show noselect" ng-show="ctrl.editMode">
        <div class="col-lg-2 col-xs-6">
            <div class="dash-add-box small-box bg-aqua" ng-click="ctrl.addNewView('LINE_CHART')" >
                <div class="inner">
                    <h3>Line Chart</h3>
                </div>
                <div class="icon">
                    <i class="fa fa-line-chart"></i>
                </div>
                <a href="javascript:void(0);"  class="small-box-footer">Add New <i class="fa fa-arrow-circle-right"></i>
                </a>
            </div>
        </div>
        <div class="col-lg-2 col-xs-6">
            <div class="dash-add-box small-box bg-green" ng-click="ctrl.addNewView('PIE_CHART')">
                <div class="inner">
                    <h3>Pie Chart</h3>
                </div>
                <div class="icon">
                    <i class="fa fa-pie-chart"></i>
                </div>
                <a href="javascript:void(0);"  class="small-box-footer">Add New <i class="fa fa-arrow-circle-right"></i>
                </a>
            </div>
        </div>
        <div class="col-lg-2 col-xs-6">
            <div class="dash-add-box small-box bg-yellow" ng-click="ctrl.addNewView('GAUGE_CHART')">
                <div class="inner">
                    <h3>Gauge</h3>
                </div>
                <div class="icon">
                    <i class="fa fa-dashboard"></i>
                </div>
                <a href="javascript:void(0);"  class="small-box-footer">Add New <i class="fa fa-arrow-circle-right"></i>
                </a>
            </div>
        </div>
        <div class="col-lg-2 col-xs-6">
            <div class="dash-add-box small-box bg-red" ng-click="ctrl.addNewView('DYNAMIC_VALUE')">
                <div class="inner">
                    <h3>Dyn. Value</h3>
                </div>
                <div class="icon">
                    <i class="fa fa-font"></i>
                </div>
                <a href="javascript:void(0);"  class="small-box-footer">Add New <i class="fa fa-arrow-circle-right"></i>
                </a>
            </div>
        </div>
        <div class="col-lg-2 col-xs-6">
            <div class="dash-add-box small-box bg-red" ng-click="ctrl.addNewView('DIGITAL_CONTROLLER')">
                <div class="inner">
                    <h3>Digital Ctrl</h3>
                </div>
                <div class="icon">
                    <i class="fa fa-font"></i>
                </div>
                <a href="javascript:void(0);"  class="small-box-footer">Add New <i class="fa fa-arrow-circle-right"></i>
                </a>
            </div>
        </div>
        <div class="col-lg-2 col-xs-6">
            <div class="dash-add-box small-box bg-red" ng-click="ctrl.addNewView('DIGITAL_CONTROLLER')">
                <div class="inner">
                    <h3>Analog Ctrl</h3>
                </div>
                <div class="icon">
                    <i class="fa fa-font"></i>
                </div>
                <a href="javascript:void(0);"  class="small-box-footer">Add New <i class="fa fa-arrow-circle-right"></i>
                </a>
            </div>
        </div>
    </div>

    <!----------------------------------------------------------------->
    <!-- Dashboards List                                             -->
    <!----------------------------------------------------------------->


    <div class="dashboards no_selection" data-gridster="ctrl.gridConf" >
        <ul ng-init="ctrl.onGridInit(this)">
            <li data-gridster-item="item.layout" data-itemid="${item.id}" data-index="${$index}"
                data-row="${item.layout.row}" data-col="${item.layout.col}" data-sizex="${item.layout.sizex}" data-sizey="${item.layout.sizey}"
                ng-repeat="item in ctrl.dashboardItems"
                ng-click="ctrl.setItemFocus($index)"
                ng-init="$last && ctrl.onRenderDashboardItems(this)">

                <div class="dash-wrapper" ng-init="ctrl.addItemListener(this, item)">
                    <div class="dash-header dash-move" ng-if="item.title">
                        <h3>${item.title}</h3>
                    </div>

                    <div class="dash-actions">
                        <span ng-click="ctrl.updatePeriod($index, true)" title="Increment Period to ${item.periodValue + 1} ${item.periodType} (UP)" ng-show="!item.realtime"><i class="fa fa-plus"></i></span>
                        <span ng-click="ctrl.updatePeriod($index, false)" title="Decrement Period to ${item.periodValue - 1} ${item.periodType} (DOWN)" ng-show="!item.realtime"><i class="fa fa-minus"></i></span>
                        <span ng-click="ctrl.editItem($index)" title="Configuration (F2)"><i class="fa fa-sliders"></i></span>
                        <span ng-click="ctrl.removeItem($index)" title="Remove" ng-show="ctrl.editMode"><i class="fa fa-remove"></i></span>
                    </div>

                    <div class="dash-body">
                        <!-- No content required -->
                    </div>

                    <!--<div class="dash-footer">Footer</div>-->
                </div>
            </li>
        </ul>
    </div>

</section>



<!----------------------------------------------------------------->
<!-- New Dashboard                                                  -->
<!----------------------------------------------------------------->
<div id="new-dash" class="modal fade" ng-controller="NewDashController as controller" ng-init="controller.init()" tabindex="-1" role="dialog" aria-labelledby="newDashboardLabel">
    <div class="modal-dialog" role="document">
        <form class="form-horizontal" ng-submit="controller.save()">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="newDashboardLabel">Dashboard</h4>
                </div>
                <div class="modal-body">
                        <div class="box-body">
                            <div class="form-group">
                                <label class="col-sm-2 control-label">Title</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" ng-model="controller.current.title" required/>
                                </div>
                            </div>
                        </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" >Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>


<!----------------------------------------------------------------->
<!-- New Item/Chart                                              -->
<!----------------------------------------------------------------->

<div id="new-item-dialog" class="modal fade" ng-controller="NewItemController as controller" ng-init="controller.init()" tabindex="-1" role="dialog" aria-labelledby="newDashboardItemLabel">
    <div class="modal-dialog" role="document">
        <form class="form-horizontal" ng-submit="controller.save()">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="newDashboardItemLabel">New Dashboard Chart / View</h4>
                </div>
                <div class="modal-body">
                    <div class="box-body">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Type</label>

                            <div class="col-sm-10">
                                <select class="form-control" ng-options="obj.id as obj.name for obj in  controller.supportedTypes"
                                        ng-model="controller.current.type" ng-change="controller.onSelectType()">
                                    <option>--</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Title</label>

                            <div class="col-sm-10">
                                <div class="input-group">
                                    <span class="input-group-addon">
                                      <input type="checkbox"  ng-model="controller.current.titleVisible" ng-change="(!controller.current.titleVisible ? controller.current.title = null : void(0))" /> Visible
                                    </span>
                                    <input type="text" class="form-control" ng-model="controller.current.title" ng-disabled="!controller.current.titleVisible" />
                                </div>
                            </div>
                        </div>
                        <div class="form-group" ng-show="controller.current.type != 'TEXT'">
                            <label class="col-sm-2 control-label">Device(s)</label>
                            <div class="col-sm-10">
                                <ui-select multiple ng-model="controller.current.monitoredDevices" theme="select2"  sortable="true" close-on-select="true" style="width: 400px;">
                                    <ui-select-match placeholder="Select device...">${$item.name}</ui-select-match>
                                    <ui-select-choices repeat="device.id as device in controller.devices | propsFilter: {name: $select.search}">
                                        <div ng-bind-html="device.name | highlight: $select.search"></div></ui-select-choices>
                                </ui-select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Real-Time</label>
                            <div class="col-sm-10">
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox" ng-model="controller.current.realtime"> Enable
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group" data-fname="period" ng-show="!controller.current.realtime">
                            <label class="col-sm-2 control-label">Period</label>
                            <div class="col-sm-10 form-inline">
                                <input type="number" style="width:60px" class="form-control" ng-model="controller.current.periodValue" value="1" />
                                <select ng-model="controller.current.periodType" class="form-control" style="width: 120px" >
                                    <option value="MINUTE" selected="selected">Minute(s)</option>
                                    <option value="HOUR">Hour(s)</option>
                                    <option value="DAY">Day(s)</option>
                                    <option value="WEEK">Week(s)</option>
                                    <option value="MONTH">Month(s)</option>
                                    <option value="RECORDS">Last Records</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group" data-fname="aggregation">
                            <label class="col-sm-2 control-label">Aggregation</label>
                            <div class="col-sm-10">
                                <select ng-model="controller.current.aggregation" class="form-control" style="max-width: 200px">
                                    <option value="AVERAGE">Average</option>
                                    <option value="MIN">Min</option>
                                    <option value="MAX">Max</option>
                                    <option value="SUM">Sum</option>
                                    <option value="COUNT">Count</option>
                                    <option value="STANDARD_DEVIATION">Standard deviation</option>
                                    <option value="NONE">None</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group" data-fname="textON">

                            <label class="col-sm-2 control-label">Labels</label>

                            <div class="input-group col-sm-10">

                                <span class="input-group-addon">Text ON</span>

                                <input name="textON" class="form-control" ng-model="controller.current.viewOptions.textON"/>

                                <span class="input-group-addon">Text OFF</span>

                                <input name="textOFF" class="form-control" ng-model="controller.current.viewOptions.textOFF"/>

                            </div>
                        </div>

                        <!-- Icons : DigitalController -->

                        <div class="form-group" data-fname="iconON">
                            <label class="col-sm-2 control-label">Icons</label>

                            <div class="input-group col-sm-10">

                                <span class="input-group-addon"><img ng-src="/images/devices/${controller.current.viewOptions.iconON}" /></span>

                                <ui-select ng-model="controller.current.viewOptions.iconON" theme="select2"  style="width: 120px;">
                                    <ui-select-match>
                                        <span ng-bind="$select.selected.id"></span>
                                    </ui-select-match>
                                    <ui-select-choices repeat="item.id as item in (controller.deviceIcons | filter: $select.search)">
                                        <img ng-src="/images/devices/${item.id}" />
                                    </ui-select-choices>
                                </ui-select>

                                <span class="input-group-addon"><img ng-src="/images/devices/${controller.current.viewOptions.iconOFF}" /></span>

                                <ui-select ng-model="controller.current.viewOptions.iconOFF" theme="select2"  style="width: 120px;">
                                    <ui-select-match>
                                        <span ng-bind="$select.selected.id"></span>
                                    </ui-select-match>
                                    <ui-select-choices repeat="item.id as item in (controller.deviceIcons | filter: $select.search)">
                                        <img ng-src="/images/devices/${item.id}" />
                                    </ui-select-choices>
                                </ui-select>
                            </div>
                        </div>


                        <!---------------- advancedOptionsBar ------------------------->

                        <div class="advancedOptionsBar" ng-click="advancedOptions = !advancedOptions">
                            Advanced <i class="fa fa-fw fa-cog"></i>
                        </div>
                        <br/>

                        <div class="advancedOptions" ng-show="advancedOptions">

                            <div class="form-group" ng-show="!controller.current.realtime">
                                <label class="col-sm-2 control-label">Group</label>
                                <div class="col-sm-10">
                                    <input type="number" style="width:60px" class="form-control" ng-model="controller.current.itemGroup" value="0" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label">Range</label>
                                <div class="col-sm-10 form-inline">
                                    <input type="number" style="width:80px" placeholder="min" class="form-control" ng-model="controller.current.viewOptions.min" value="0" />
                                    <input type="number" style="width:80px" placeholder="max" class="form-control" ng-model="controller.current.viewOptions.max" value="0" />
                                    (Chart options)
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" >Save changes</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- /.content -->
